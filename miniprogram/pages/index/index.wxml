<!--index.wxml-->
<view class="container">
  <!-- 标题区域 -->
  <view class="header">
    <text class="title">喵喵美颜</text>
    <text class="subtitle">让每一张照片都变得更加清晰</text>
  </view>

  <!-- 功能介绍区域 -->
  <view class="features-section">
    <view class="section-title">
      <text>AI 图片增强</text>
    </view>
    
    <view class="features-grid">
      <view class="feature-card">
        <text class="feature-icon">✨</text>
        <text class="feature-title">智能增强</text>
        <text class="feature-desc">AI 算法自动优化图片质量</text>
      </view>
      
      <view class="feature-card">
        <text class="feature-icon">⚡</text>
        <text class="feature-title">快速处理</text>
        <text class="feature-desc">10-30秒完成图片增强</text>
      </view>
      
      <view class="feature-card">
        <text class="feature-icon">📱</text>
        <text class="feature-title">即时预览</text>
        <text class="feature-desc">实时对比原图和处理结果</text>
      </view>
      
      <view class="feature-card">
        <text class="feature-icon">💾</text>
        <text class="feature-title">一键保存</text>
        <text class="feature-desc">直接保存到手机相册</text>
      </view>
    </view>
  </view>

  <!-- 图片处理功能区域 -->
  <view class="processing-section">
    <view class="section-title">
      <text>开始处理</text>
    </view>
    
    <!-- 图片上传区域 -->
    <view class="upload-section">
      <view wx:if="{{!selectedImage}}" class="upload-area" bindtap="chooseImage">
        <view class="upload-icon">📷</view>
        <text class="upload-text">点击选择图片</text>
        <text class="upload-hint">支持 JPG、PNG、AVIF 格式</text>
      </view>
      
      <view wx:else class="image-preview">
        <image class="preview-image" src="{{selectedImage}}" mode="aspectFit"></image>
        <view class="image-info">
          <text class="file-name">{{fileName}}</text>
          <text class="file-size">{{fileSize}}</text>
        </view>
        <button class="change-btn" bindtap="chooseImage">重新选择</button>
      </view>
    </view>

    <!-- 处理按钮 -->
    <view class="action-section" wx:if="{{selectedImage}}">
      <button 
        class="enhance-btn {{isProcessing ? 'processing' : ''}}" 
        bindtap="enhanceImage"
        disabled="{{isProcessing}}"
      >
        <text wx:if="{{!isProcessing}}">开始增强</text>
        <text wx:else>处理中...</text>
      </button>
    </view>

    <!-- 结果展示区域 -->
    <view class="result-section" wx:if="{{enhancedImage}}">
      <view class="result-title">
        <text>处理结果</text>
        <text class="preview-hint">点击图片可放大查看，支持左右滑动切换</text>
      </view>
      
      <view class="comparison-container">
        <!-- 原图 -->
        <view class="image-container">
          <text class="image-label">原图</text>
          <view class="image-wrapper" bindtap="previewOriginalImage">
            <image class="result-image" src="{{selectedImage}}" mode="aspectFit"></image>
            <view class="preview-overlay">
              <text class="preview-icon">🔍</text>
            </view>
          </view>
          <text class="image-size">{{originalImageSize}}</text>
          <text class="file-size-info">{{originalFileSize}}</text>
        </view>
        
        <!-- 处理后图片 -->
        <view class="image-container">
          <text class="image-label">增强后</text>
          <view class="image-wrapper" bindtap="previewEnhancedImage">
            <image class="result-image" src="{{enhancedImage}}" mode="aspectFit"></image>
            <view class="preview-overlay">
              <text class="preview-icon">🔍</text>
            </view>
          </view>
          <text class="image-size">{{enhancedImageSize}}</text>
          <text class="file-size-info">{{enhancedFileSize}}</text>
        </view>
      </view>

      <!-- 下载按钮 -->
      <view class="download-section">
        <button class="download-btn" bindtap="downloadImage">下载增强图片</button>
      </view>
    </view>
  </view>

  <!-- 处理进度提示 -->
  <view wx:if="{{isProcessing}}" class="processing-overlay">
    <view class="processing-content">
      <view class="loading-spinner"></view>
      <text class="processing-text">AI正在增强您的图片...</text>
      <text class="progress-text">{{progress}}%</text>
      
      <!-- 进度条 -->
      <view class="progress-bar-container">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progress}}%"></view>
        </view>
      </view>
      
      <text class="processing-hint">请耐心等待，通常需要10-30秒</text>
    </view>
  </view>
</view>